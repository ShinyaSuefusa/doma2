

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>エンティティクラス &mdash; Doma 2.0 ドキュメント</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Doma 2.0 ドキュメント" href="index.html"/>
        <link rel="next" title="Daoインタフェース" href="dao.html"/>
        <link rel="prev" title="ドメインクラス" href="domain.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Doma
          

          
          </a>

          
            
            
              <div class="version">
                2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">設定</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic.html">基本型</a></li>
<li class="toctree-l1"><a class="reference internal" href="domain.html">ドメインクラス</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">エンティティクラス</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id3">エンティティ定義</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id4">エンティティリスナー</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">ネーミング規約</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id6">イミュータブルなエンティティ</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id7">テーブル</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id8">フィールド定義</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id9">カラム</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id10">識別子</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id11">識別子の自動生成</a></li>
<li class="toctree-l4"><a class="reference internal" href="#identity">IDENTITYを使った識別子の自動生成</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id12">シーケンスを使った識別子の自動生成</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id13">テーブルを使った識別子の自動採番</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id14">バージョン</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id15">非永続的なフィールド</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id16">取得時の状態を管理するフィールド</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id17">メソッド定義</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id18">利用例</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dao.html">Daoインタフェース</a></li>
<li class="toctree-l1"><a class="reference internal" href="query/index.html">クエリ</a></li>
<li class="toctree-l1"><a class="reference internal" href="query-builder/index.html">クエリビルダ</a></li>
<li class="toctree-l1"><a class="reference internal" href="sql.html">SQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="expression.html">式言語</a></li>
<li class="toctree-l1"><a class="reference internal" href="transaction.html">トランザクション</a></li>
<li class="toctree-l1"><a class="reference internal" href="annotation-processing.html">注釈処理</a></li>
<li class="toctree-l1"><a class="reference internal" href="build.html">ビルド</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="development.html">Doma の開発</a></li>
<li class="toctree-l1"><a class="reference internal" href="integration-test.html">統合テスト</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="release-notes.html">リリースノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Doma 2 における主要な変更点</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Doma</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>エンティティクラス</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/entity.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="id1">
<h1><a class="toc-backref" href="#id19">エンティティクラス</a><a class="headerlink" href="#id1" title="このヘッドラインへのパーマリンク">¶</a></h1>
<div class="contents topic" id="id2">
<p class="topic-title first">目次</p>
<ul class="simple">
<li><a class="reference internal" href="#id1" id="id19">エンティティクラス</a><ul>
<li><a class="reference internal" href="#id3" id="id20">エンティティ定義</a><ul>
<li><a class="reference internal" href="#id4" id="id21">エンティティリスナー</a></li>
<li><a class="reference internal" href="#id5" id="id22">ネーミング規約</a></li>
<li><a class="reference internal" href="#id6" id="id23">イミュータブルなエンティティ</a></li>
<li><a class="reference internal" href="#id7" id="id24">テーブル</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id8" id="id25">フィールド定義</a><ul>
<li><a class="reference internal" href="#id9" id="id26">カラム</a></li>
<li><a class="reference internal" href="#id10" id="id27">識別子</a></li>
<li><a class="reference internal" href="#id14" id="id28">バージョン</a></li>
<li><a class="reference internal" href="#id15" id="id29">非永続的なフィールド</a></li>
<li><a class="reference internal" href="#id16" id="id30">取得時の状態を管理するフィールド</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id17" id="id31">メソッド定義</a></li>
<li><a class="reference internal" href="#id18" id="id32">利用例</a></li>
</ul>
</li>
</ul>
</div>
<p>Entity（エンティティ）は、データベースのテーブルやクエリの結果セットに対応します。</p>
<div class="section" id="id3">
<h2><a class="toc-backref" href="#id20">エンティティ定義</a><a class="headerlink" href="#id3" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>エンティティクラスは <code class="docutils literal"><span class="pre">&#64;Entity</span></code> を注釈して示します。</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Employee</span> <span class="o">{</span>
    <span class="o">...</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="section" id="id4">
<h3><a class="toc-backref" href="#id21">エンティティリスナー</a><a class="headerlink" href="#id4" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>エンティティがデータベースに対し挿入、更新、削除される直前/直後に処理を実行したい場合、
<code class="docutils literal"><span class="pre">&#64;Entity</span></code> の <code class="docutils literal"><span class="pre">listener</span></code> 要素に <code class="docutils literal"><span class="pre">EntityListener</span></code> の実装クラスを指定できます。</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Entity</span><span class="o">(</span><span class="n">listener</span> <span class="o">=</span> <span class="n">EmployeeEntityListener</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Employee</span> <span class="o">{</span>
    <span class="o">...</span>
<span class="o">}</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">listener</span></code> 要素に何も指定しない場合、エンティティクラスが他のエンティティクラスを継承
しているかどうかで採用する設定が変わります。</p>
<ul class="simple">
<li>継承している場合、親エンティティクラスの設定を引き継ぎます</li>
<li>継承していない場合、何も行いません（ <code class="docutils literal"><span class="pre">NullEntityListener</span></code> が使用されます）</li>
</ul>
</div>
<div class="section" id="id5">
<h3><a class="toc-backref" href="#id22">ネーミング規約</a><a class="headerlink" href="#id5" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>エンティティに対応するテーブル名やプロパティに対応するカラム名を解決するためのネーミング規約
を変更したい場合、 <code class="docutils literal"><span class="pre">naming</span></code> 要素に <code class="docutils literal"><span class="pre">NamingType</span></code> の列挙型を指定できます。</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Entity</span><span class="o">(</span><span class="n">naming</span> <span class="o">=</span> <span class="n">NamingType</span><span class="o">.</span><span class="na">SNAKE_UPPER_CASE</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EmployeeInfo</span> <span class="o">{</span>
    <span class="o">...</span>
<span class="o">}</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">naming</span></code> 要素に何も指定しない場合、エンティティクラスが他のエンティティクラスを継承している
かどうかで採用する設定が変わります。</p>
<ul class="simple">
<li>継承している場合、親エンィティクラスの設定を引き継ぎます</li>
<li>継承していない場合、何も行いません（ <code class="docutils literal"><span class="pre">NamingType.NONE</span></code> が使用されます）</li>
</ul>
<p><code class="docutils literal"><span class="pre">NamingType.SNAKE_UPPER_CASE</span></code> は、エンティティ名やプロパティ名を
スネークケース（アンダースコア区切り）の大文字に変換します。
この例の場合、テーブル名はEMPLOYEE_INFOになります。</p>
<p><code class="docutils literal"><span class="pre">naming</span></code> 要素に何も指定しない場合、デフォルトでは、テーブル名にはエンティティクラスの単純名、
カラム名にはプロパティ名が使用されます。</p>
<p>ネーミング規約は、 <code class="docutils literal"><span class="pre">&#64;Table</span></code> や <code class="docutils literal"><span class="pre">&#64;Colum</span></code> の <code class="docutils literal"><span class="pre">name</span></code> 要素が指定されない場合のみ使用されます。
<code class="docutils literal"><span class="pre">&#64;Table</span></code> や <code class="docutils literal"><span class="pre">&#64;Colum</span></code> の <code class="docutils literal"><span class="pre">name</span></code> 要素が指定された場合は、 <code class="docutils literal"><span class="pre">name</span></code> 要素
に指定した値が使用され、ネーミング規約は適用されません。</p>
</div>
<div class="section" id="id6">
<h3><a class="toc-backref" href="#id23">イミュータブルなエンティティ</a><a class="headerlink" href="#id6" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>エンティティをイミュータブルなオブジェクトとして扱いたい場合は
<code class="docutils literal"><span class="pre">&#64;Entity</span></code> の <code class="docutils literal"><span class="pre">immutable</span></code> 要素に <code class="docutils literal"><span class="pre">true</span></code> を設定します。</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Entity</span><span class="o">(</span><span class="n">immutable</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Employee</span> <span class="o">{</span>
    <span class="nd">@Id</span>
    <span class="kd">final</span> <span class="n">Integer</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">final</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="nd">@Version</span>
    <span class="kd">final</span> <span class="n">Integer</span> <span class="n">version</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Employee</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">,</span> <span class="n">String</span> <span class="n">name</span><span class="o">,</span> <span class="n">Integer</span> <span class="n">version</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">version</span> <span class="o">=</span> <span class="n">version</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>永続的なフィールドには <code class="docutils literal"><span class="pre">final</span></code> 修飾子が必須です。</p>
</div>
<div class="section" id="id7">
<h3><a class="toc-backref" href="#id24">テーブル</a><a class="headerlink" href="#id7" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>エンティティに対応するテーブル情報を指定するには、 <code class="docutils literal"><span class="pre">&#64;Table</span></code> を使用します。</p>
<p><code class="docutils literal"><span class="pre">name</span></code> 要素でテーブル名を指定できます。</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Entity</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;EMP&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Employee</span> <span class="o">{</span>
    <span class="o">...</span>
<span class="o">}</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">&#64;Table</span></code> を使用しない、もしくは <code class="docutils literal"><span class="pre">&#64;Table</span></code> の <code class="docutils literal"><span class="pre">name</span></code> 要素を使用しない場合、
テーブル名は <a class="reference internal" href="#id5">ネーミング規約</a> により解決されます。</p>
</div>
</div>
<div class="section" id="id8">
<h2><a class="toc-backref" href="#id25">フィールド定義</a><a class="headerlink" href="#id8" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>エンティティクラスのフィールドはデフォルトで永続的です。
つまり、テーブルや結果セットのカラムに対応します。
フィールドの型は次のいずれかでなければいけません。</p>
<ul class="simple">
<li><a class="reference internal" href="basic.html"><em>基本型</em></a></li>
<li><a class="reference internal" href="domain.html"><em>ドメインクラス</em></a></li>
<li><a class="reference internal" href="basic.html"><em>基本型</em></a> または <a class="reference internal" href="domain.html"><em>ドメインクラス</em></a> のいずれかを要素とするjava.util.Optional</li>
<li>java.util.OptionalInt</li>
<li>java.util.OptionalLong</li>
<li>java.util.OptionalDouble</li>
</ul>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Employee</span> <span class="o">{</span>
    <span class="o">...</span>
    <span class="n">Integer</span> <span class="n">employeeId</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="section" id="id9">
<h3><a class="toc-backref" href="#id26">カラム</a><a class="headerlink" href="#id9" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>カラム情報を指定するには、 <code class="docutils literal"><span class="pre">&#64;Column</span></code> を使用します。</p>
<p><code class="docutils literal"><span class="pre">name</span></code> 要素でカラム名を指定できます。</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Column</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;ENAME&quot;</span><span class="o">)</span>
<span class="n">String</span> <span class="n">employeeName</span><span class="o">;</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">insertable</span></code> 要素や <code class="docutils literal"><span class="pre">updatable</span></code> 要素で挿入や更新の対象とするかどうかを指定できます。</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Column</span><span class="o">(</span><span class="n">insertable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">,</span> <span class="n">updatable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
<span class="n">String</span> <span class="n">employeeName</span><span class="o">;</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">&#64;Column</span></code> を使用しない、もしくは <code class="docutils literal"><span class="pre">&#64;Column</span></code> の <code class="docutils literal"><span class="pre">name</span></code> 要素を使用しない場合、
カラム名は <a class="reference internal" href="#id5">ネーミング規約</a> により解決されます。</p>
</div>
<div class="section" id="id10">
<h3><a class="toc-backref" href="#id27">識別子</a><a class="headerlink" href="#id10" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>識別子(主キー)であることを指定するには、 <code class="docutils literal"><span class="pre">&#64;Id</span></code> を使います。</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Id</span>
<span class="n">Integer</span> <span class="n">id</span><span class="o">;</span>
</pre></div>
</div>
<p>複合主キーの場合は <code class="docutils literal"><span class="pre">&#64;Id</span></code> を複数指定します。</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Id</span>
<span class="n">Integer</span> <span class="n">id</span><span class="o">;</span>

<span class="nd">@Id</span>
<span class="n">Integer</span> <span class="n">id2</span><span class="o">;</span>
</pre></div>
</div>
<div class="section" id="id11">
<h4>識別子の自動生成<a class="headerlink" href="#id11" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>識別子を自動生成するには <code class="docutils literal"><span class="pre">&#64;GeneratedValue</span></code> を注釈して示します。
フィールドの型は以下のいずれかでなければいけません。</p>
<ul class="simple">
<li>java.lang.Number のサブタイプ</li>
<li>java.lang.Number のサブタイプを値とする <a class="reference internal" href="domain.html"><em>ドメインクラス</em></a></li>
<li>上記のいずれかを要素の型とする java.util.Optional</li>
<li>OptionalInt</li>
<li>OptionalLong</li>
<li>OptionalDouble</li>
<li>数値のプリミティブ型</li>
</ul>
</div>
<div class="section" id="identity">
<h4>IDENTITYを使った識別子の自動生成<a class="headerlink" href="#identity" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>データベースのIDENTITY自動生成機能を利用する方法です。
RDBMSによってはサポートされていません。
フィールドに対応するカラムの定義でIDENTITY自動生成を有効にしておく必要があります。</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Id</span>
<span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="n">GenerationType</span><span class="o">.</span><span class="na">IDENTITY</span><span class="o">)</span>
<span class="n">Integer</span> <span class="n">id</span><span class="o">;</span>
</pre></div>
</div>
</div>
<div class="section" id="id12">
<h4>シーケンスを使った識別子の自動生成<a class="headerlink" href="#id12" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>データベースのシーケンスを利用する方法です。
RDBMSによってはサポートされていません。</p>
<p><code class="docutils literal"><span class="pre">&#64;SequenceGenerator</span></code> では、シーケンスの名前、割り当てサイズ、初期値等を設定できます。
データベースにあらかじめシーケンスを定義しておく必要がありますが、
その定義は <code class="docutils literal"><span class="pre">&#64;SequenceGenerator</span></code> の定義とあわせておく必要があります。</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Id</span>
<span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="n">GenerationType</span><span class="o">.</span><span class="na">SEQUENCE</span><span class="o">)</span>
<span class="nd">@SequenceGenerator</span><span class="o">(</span><span class="n">sequence</span> <span class="o">=</span> <span class="s">&quot;EMPLOYEE_SEQ&quot;</span><span class="o">)</span>
<span class="n">Integer</span> <span class="n">id</span><span class="o">;</span>
</pre></div>
</div>
</div>
<div class="section" id="id13">
<h4>テーブルを使った識別子の自動採番<a class="headerlink" href="#id13" title="このヘッドラインへのパーマリンク">¶</a></h4>
<p>生成される識別子をテーブルで管理する方法です。
すべてのRDBMSで利用できます。</p>
<p><code class="docutils literal"><span class="pre">&#64;TableGenerator</span></code> では、テーブル名、割り当てサイズ、初期値等を設定できます。
データベースにあらかじめテーブルを定義しておく必要がありますが、
その定義は <code class="docutils literal"><span class="pre">&#64;TableGenerator</span></code> の定義とあわせておく必要があります。
デフォルトでは、 <code class="docutils literal"><span class="pre">ID_GENERATOR</span></code> という名前のテーブルに、文字列型の <code class="docutils literal"><span class="pre">PK</span></code> と数値型の <code class="docutils literal"><span class="pre">VALUE</span></code>
という2つのカラムが定義されているものとして動作します（ <code class="docutils literal"><span class="pre">PK</span></code> カラムが主キーです）。
<code class="docutils literal"><span class="pre">PK</span></code> カラムにはエンティティクラスごとの一意な名前、 <code class="docutils literal"><span class="pre">VALUE</span></code> カラムには識別子の値が格納されます。
テーブルには、エンティティクラスごとのレコードをあらかじめ登録しておく必要があります。</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Id</span>
<span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="n">GenerationType</span><span class="o">.</span><span class="na">TABLE</span><span class="o">)</span>
<span class="nd">@TableGenerator</span><span class="o">(</span><span class="n">pkColumnValue</span> <span class="o">=</span> <span class="s">&quot;EMPLOYEE_ID&quot;</span><span class="o">)</span>
<span class="n">Integer</span> <span class="n">id</span><span class="o">;</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">&#64;TableGenerator</span></code> の <code class="docutils literal"><span class="pre">pkColumnValue</span></code> 要素には、 識別子を管理するテーブル
（デフォルトでは、 <code class="docutils literal"><span class="pre">ID_GENERATOR</span></code> という名前のテーブル）の主キーの値を指定します。</p>
</div>
</div>
<div class="section" id="id14">
<h3><a class="toc-backref" href="#id28">バージョン</a><a class="headerlink" href="#id14" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>楽観的排他制御用のバージョンは <code class="docutils literal"><span class="pre">&#64;Version</span></code> を注釈して示します。
フィールドの型は以下のいずれかでなければいけません。</p>
<ul class="simple">
<li>java.lang.Number のサブタイプ</li>
<li>java.lang.Number のサブタイプを値とする <a class="reference internal" href="domain.html"><em>ドメインクラス</em></a></li>
<li>上記のいずれかを要素の型とする java.util.Optional</li>
<li>OptionalInt</li>
<li>OptionalLong</li>
<li>OptionalDouble</li>
<li>数値のプリミティブ型</li>
</ul>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Version</span>
<span class="n">Integer</span> <span class="n">version</span><span class="o">;</span>
</pre></div>
</div>
</div>
<div class="section" id="id15">
<h3><a class="toc-backref" href="#id29">非永続的なフィールド</a><a class="headerlink" href="#id15" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>非永続的なフィールドは、テーブルや結果セットのカラムに対応しません。</p>
<p><code class="docutils literal"><span class="pre">&#64;Transient</span></code> を注釈して示します。</p>
<p>フィールドの型や可視性に制限はありません。</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Transient</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">nameList</span><span class="o">;</span>
</pre></div>
</div>
</div>
<div class="section" id="id16">
<h3><a class="toc-backref" href="#id30">取得時の状態を管理するフィールド</a><a class="headerlink" href="#id16" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>取得時の状態とは、エンティティがDaoから取得されときの全プロパティの値です。
取得時の状態を保持しておくことで、更新処理を実行する際、UPDATE文のSET句に変更したフィールドのみを含められます。
取得時の状態を管理するフィールドは、テーブルや結果セットのカラムに対応しません。</p>
<p><code class="docutils literal"><span class="pre">&#64;OriginalStates</span></code> を注釈して示します。</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@OriginalStates</span>
<span class="n">Employee</span> <span class="n">originalStates</span><span class="o">;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id17">
<h2><a class="toc-backref" href="#id31">メソッド定義</a><a class="headerlink" href="#id17" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>メソッドの定義に制限はありません。</p>
<p>フィールドの可視性を <code class="docutils literal"><span class="pre">protected</span></code> やパッケージプライベートにして <code class="docutils literal"><span class="pre">public</span></code> なメソッド経由で
アクセスすることも、メソッドを一切使用せず <code class="docutils literal"><span class="pre">public</span></code> フィールドに直接アクセスすること
もどちらもサポートされています。</p>
</div>
<div class="section" id="id18">
<h2><a class="toc-backref" href="#id32">利用例</a><a class="headerlink" href="#id18" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>インスタンス化して利用します。</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">Employee</span> <span class="n">employee</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Employee</span><span class="o">();</span>
<span class="n">employee</span><span class="o">.</span><span class="na">setEmployeeId</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
<span class="n">employee</span><span class="o">.</span><span class="na">setEmployeeName</span><span class="o">(</span><span class="s">&quot;SMITH&quot;</span><span class="o">);</span>
<span class="n">employee</span><span class="o">.</span><span class="na">setSalary</span><span class="o">(</span><span class="k">new</span> <span class="n">BigDecimal</span><span class="o">(</span><span class="mi">1000</span><span class="o">));</span>
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="dao.html" class="btn btn-neutral float-right" title="Daoインタフェース" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="domain.html" class="btn btn-neutral" title="ドメインクラス" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Toshihiro Nakamura.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>